package com.shoo.hook.pms;

import android.content.Context;
import android.util.Log;

/**
 * Created by Shoo on 17-9-11.
 */

public class TPmsHooker {

    private static final String TAG = "THookPackageInfo";

    public static void test(Context context) {
//        testHookPackageInfo(context);
        testSignature(context);
    }

    private static void testSignature(Context context) {
        /*
        signature = 3082030d308201f5a00302010202042648edd1300d06092a864886f70d01010b05003037310b30090603550406130255533110300e060355040a1307416e64726f6964311630140603550403130d416e64726f6964204465627567301e170d3135303831343037333335335a170d3435303830363037333335335a3037310b30090603550406130255533110300e060355040a1307416e64726f6964311630140603550403130d416e64726f696420446562756730820122300d06092a864886f70d01010105000382010f003082010a028201010091b31bc43683ad140096f73812e867d8e4a3ef2bd544059ebe4698a9785885ba14951e6684e70c96234b3440af12527666b19ea34d72540a3dbeeeb89f035030148cce3a79ea6ee90b1f129f3c009fea419a478cb4109524fc0a82efa562c16dea82d5a3b9820f44f31b459b9a2d96ef6856b3f7f48266a996bb45bf89e235954c12085c0cafb617ea44f8339a8d9600439ca3742775d581d1f3ded823bccc38de49b3935731c85e094277482866de0f1df9fe60c94fac61462811dee4ef59fd982551ef0126990534fc5e28f4c4ffc4ed6aec7a19b76f1edf0e718e0e5c74309581cc9a3fa46a4f02312331bb2e0ae0e249c160626df9c17ca1ba4a05256ee90203010001a321301f301d0603551d0e041604146d1ef9aaef4187fd75b121d3303e8b5233beafe1300d06092a864886f70d01010b0500038201010090fb13eeca7faece575462c5dd82809917afe50782d0204ce7d1615a3e5d85d2971dbba131ead243ec862b76aa52b2615639dfd0a0969204605836ed7d8908752442e27db2ef46483894d6d1df42c630cbdc4168ada75cf499e7a97336cd9876cd8e737af6f50d1c82e029ff26b12de094ca6f6786d0a312281a7971813b1a6f19463357260e1c2f4fe3dea51c0d4ae600615141b4dd77be3482ca48fc254e5afe6ec051635cb98a896e15aa3423012986c540c11c5c862abb0c1e807d410bb3fb160ebcc50839b706cee43b175d09955e17a55ff2b236df34a36608af3e76bd6071d3e33d62f10a68ad38bc63c1a4b4a96764a8baa1007368423656a5dae6b4
        hashCode = -858307025
        signInfo = 0e2ae137b1abcbe1130a22a807f9de1f
         */
        String signature = PackageUtils.getSignCharsString(context);
        int hashCode = PackageUtils.getSignHashCode(context);
        String signInfo = PackageUtils.getSignHexString(context);
        Log.d(TAG, "signature = " + signature + "\n hashCode = " + hashCode + "\n signInfo = " + signInfo);
    }

    private static void testHookPackageInfo(Context context) {
        /*
        THookPackageInfo: before hook: signature = 308201dd30820146020101300d06092a864886f70d010105050030373116301406035504030c0d416e64726f69642044656275673110300e060355040a0c07416e64726f6964310b3009060355040613025553301e170d3137303930353131333033335a170d3437303832393131333033335a30373116301406035504030c0d416e64726f69642044656275673110300e060355040a0c07416e64726f6964310b300906035504061302555330819f300d06092a864886f70d010101050003818d0030818902818100ce1407932ae9fcf5c66582a79e9d725310c38b70362882b35d048fdae59463171757714877554f6d42e961ac3733e4464ca6e675f4d8481d02a19ef1b8b4b829e9e5e05ceee18af09a3c4e0e551c2f035faed9974fa8faad45c5cf1687f6d2fa485418d5d79f431a0723fb6d085347dc40aacf58698d011b89fe4f8493af08290203010001300d06092a864886f70d010105050003818100574e85ff14e7289a0bf8e0bd5ccbc600aafec6a14588eaea06343334df68e0bafe4a30f17dca3562f96870f39fc60c587455ecb81de82df23307152bdd3d670712fd4ec11adf0d3df2ba62a05f915559eeff0244c305c3558fbe0d72fbe59abdab4e1f568f4c648407c364cbadde41f95d2611546031baab7d417e7e439c8e4c
        THookPackageInfo: after hook: signature = abcd
         */
        String signature = PackageUtils.getSignCharsString(context);
        Log.d(TAG, "before hook: signature = " + signature);

        PmsHooker.hookPackageInfo("abcd", 12345);

        signature = PackageUtils.getSignCharsString(context);
        Log.d(TAG, "after hook: signature = " + signature);
    }

}
